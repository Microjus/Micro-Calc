#!/usr/bin/env bash

# Autor: Microjus - Dark-Shell 
# Criaçao: 01/12/2021
# Script simples escrito em bash que calcula
# Adição, divisao, subtraçao 
# Multiplicaçao e raiz quadrada.

#------------------------------VARIAVEIS---------------------------------------|

declare -r ROOT_UID=0    # Somente usuários com $UID 0 têm privilégios de administrador.
declare -r NOT_ROOT=87   # Codigo de saida de erro para usuarios nao administrador.
declare -r NOT_FOUND=404 # Codigo de saida de erro para programa nao encontrado.

#-------------------------------TESTES-----------------------------------------|

# Verifica se o usiario é administrador do sistema.

[[ "$UID" -ne "$ROOT_UID" ]] && { printf "\033cE: Execute como adminstrador." ; exit "$NOT_ROOT" ; }

#------------------------------------------------------------------------------|

trap ctrl_c INT

ctrl_c() {

        printf "\33c[+] (Ctrl + C ) Detectado, Tentativa de saida ...\n" ; sleep 2s
        printf "\n[+] Encerrando serviços , Aguarde  ...\n"
        # Funçao de encerramento
        printf '\n[+] Obrigado por usar este programa  =).'
        exit 1 
}

function menu() {
	
	clear ; echo '
	|-----------------------|
	|                       |
	|   MICRO CALCULATOR    |
	|                       |
	|-----------------------|
	
	[ 1 ] - Adição
	[ 2 ] - Divisão
	[ 3 ] - Subtração
	[ 4 ] - Multiplicação
	[ 5 ] - Raiz quadrada
	[ 0 ] - Sair
	'
	read -r -p '[+] Digite uma opção: ' opt
	
	case $opt in 
		
		1) adc ;;
		2) div ;;
		3) subtr ;;
		4) mult ;;
		5) raiz ;;
		0) enc;;
		*)
		printf "\33c[+] Opção Invalida!" ; sleep 1 ; menu
		esac
}

function enc() {

	clear ; printf "\33c[+] Obrigado por usar este programa!" ; sleep 1s ; exit 0
}

function menu2() {

	echo '
	[1] - Menu principal"
	[2] - Repetir"
	[3] - Sair
	'
}

function adc() {

	clear ; read -r -p '[+] Digite um numero: ' num1
	read -r -p '[+] Digite o numero a ser somado: ' num2
	
		adc=$(( $num1 + $num2 ))
	
	printf "\33c|  O resultado é: $adc  |"
	menu2
	read -p "[+] Digite uma opção: " option

if [ "$option" = 1 ] 
	then
	
	menu

elif [ "$option" = 2 ] 
	then

	adc
       
elif [ "$option" = 3 ] 
	then
	enc
	else 
       	clear ; echo "[+] Opção Invalida!" ; sleep 1 ; clear ; menu
	fi
}

function mult() {

	clear ; read -r -p '[+] Digite um numero: ' num1
	read -r -p "[+] Digite o numero a ser multiplicado: " num2
	multiplicacao=$(( $num1 * $num2 ))
	clear
	echo "|  O resultado é: $multiplicacao  |"
	menu2
	read -p "[+] Digite uma opção: " option0

if [ "$option0" = 1 ] 
	then
	
	menu

elif [ "$option0" = 2 ] 
	then

	multiplicacao
       
elif [ "$option0" = 3 ] 
	then
	clear ; echo "Bay!!! :)" ; sleep 1 ; clear ; exit 
	else 
       	clear ; echo "[+] Opção Invalida!" ; sleep 1 ; clear ; menu
	fi


}

function divisao() {

	clear
	read -p "[+] Digite um numero: " num1
	read -p "[+] Digite outro numero: " num1
	divisao=$(( $num1 / $num2 ))
	clear
	echo "|  O resultado da divisao é: $divisao  |"
	menu2
	read -p "[+] Digite uma opção: " option2

if [ "$option2 " = 1 ] 
	then
	
	menu

elif [ "$option2" = 2 ] 
	then

	divisao
       
elif [ "$option2" = 3 ] 
	then
	clear ; echo "Bay!!! :)" ; sleep 1 ; clear ; exit 
	else
	clear ; echo "[+] Opção Invalida!" ; sleep 1 ; menu 
	fi

}

function subtracao() {

	clear
	read -p "[+] Digite um numero: " num1
	read -p "[+] Digite um numero a ser subtraido: " num2
	subtracao=$(( $num1 - $num2 ))
	clear
	echo "|  O resultado da subtraçao é: $subtracao  |"
	menu2
	read -p "[+] Digite uma opção: " option3

if [ "$option3 " = 1 ] 
	then
	
	menu

elif [ "$option3" = 2 ] 
	then

	subtracao
       
elif [ "$option3" = 3 ] 
	then
	clear ; echo "Bay!!! :)" ; sleep 1 ; clear ; exit 
	else 
	clear ; echo "[+] Opção Invalida!" ; sleep 1 ; clear ; menu
	fi

}

function raiz() {

	clear
	read -p "[+] Digite um numero: " num1
	raiz=$(echo "$num1" | awk '{print sqrt($1)}')
	clear
 	echo "|  A raiz quadrada de $num1 é: $raiz  |"
	menu2
	read -p "[+] Digite uma opção: " option8

if [ "$option8" = 1 ] 
	then

	menu

elif [ "$option8" = 2 ] 
	then

	raiz
       
elif [ "$option8" = 3 ] 
	then	
	enc
	else 
	clear ; echo "[+] Opção Invalida!" ; sleep 1 ; clear ; menu
	fi
}

menu
